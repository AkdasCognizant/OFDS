<app-navbar></app-navbar>

<div class="container-fluid py-4 main-content-container">

    <!-- Header -->
    <div class="cart-header mb-4">
        <a routerLink="/home" class="back-link">
            <i class="bi bi-arrow-left"></i>&nbsp;Back to Home
        </a>
        <h1 class="checkout-title">Cart</h1>
    </div>

    <!-- Loading State -->
    <!-- <div *ngIf="!cart" class="text-center mt-5">
        <div class="spinner-border" role="status"></div>
        <p class="mt-2">Loading your cart...</p>
    </div> -->

    <!-- Empty Cart -->
    <div *ngIf="!cart" class="text-center mt-5">
        <h4>Your cart is empty</h4>
        <p class="text-muted">Looks like you haven't added anything yet.</p>
        <a class="btn btn-primary" routerLink="/">Browse Menu</a>
    </div>

    <!-- Cart Items + Summary -->
    <div *ngIf="cart && cart.items.length > 0" class="row">

        <!-- Cart Items List -->
        <div class="col-lg-8 col-md-7">
            <div class="cart-items-scroll">
                <div *ngFor="let item of cart.items; trackBy: trackByLine" class="card mb-3 shadow-sm">
                    <div class="row g-0">

                        <!-- Image Column -->
                        <div class="col-md-4">
                            <img [src]=" item.image " class="img-fluid rounded-start"
                                style="height:135px; object-fit:cover;" alt="{{ item.name }}" />
                        </div>

                        <!-- Details & Controls -->
                        <div class="col-md-8">
                            <div class="card-body position-relative py-2 px-3">
                                <div class="item-total-top-right fw-bold text-primary">
                                    â‚¹{{ item.price * item.quantity }}
                                </div>

                                <h5 class="fw-bold fs-6">{{ item.name }}</h5>
                                <p class="text-muted mt-1" *ngIf="cart?.restaurantName">
                                    From: <strong>{{ cart.restaurantName }}</strong>
                                </p>

                                <p class="mb-1">
                                    <span *ngIf="item.originalPrice && item.originalPrice > item.price"
                                        class="text-muted text-decoration-line-through">
                                        â‚¹{{ item.originalPrice }}
                                    </span>
                                    <span class="fw-bold text-success ms-2">
                                        â‚¹{{ item.price }}
                                    </span>
                                </p>

                                <div class="d-flex align-items-center">
                                    <!-- Decrease -->
                                    <button class="btn btn-outline-secondary btn-sm" (click)="decrease(item.itemID)"
                                        [disabled]="item.quantity === 1">
                                        âˆ’
                                    </button>

                                    <!-- Quantity Display -->
                                    <span class="mx-2">{{ item.quantity }}</span>

                                    <!-- Increase -->
                                    <button class="btn btn-outline-secondary btn-sm" (click)="increase(item.itemID)">
                                        +
                                    </button>

                                    <!-- Remove -->
                                    <button class="btn btn-outline-danger btn-sm ms-auto" (click)="remove(item)">
                                        ðŸ—‘ Remove
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Order Summary -->
        <div class="col-lg-4 col-md-5">
            <div class="card p-4 shadow-sm">
                <h4>Order Summary</h4>

                <div class="d-flex justify-content-between">
                    <span>Subtotal:</span>
                    <span>â‚¹{{ getSubtotal() }}</span>
                </div>

                <div class="d-flex justify-content-between">
                    <span>Delivery Fee:</span>
                    <span [ngClass]="{ 'text-success': getDeliveryFee() === 0 }">
                        {{ getDeliveryFee() === 0 ? 'FREE' : 'FREE' }}
                    </span>
                </div>

                <div class="d-flex justify-content-between">
                    <span>GST (18%):</span>
                    <span>â‚¹{{ getGST() }}</span>
                </div>

                <hr />

                <div class="d-flex justify-content-between fw-bold">
                    <span>Total:</span>
                    <span>
                        â‚¹{{ getSubtotal() + getGST() }}
                    </span>
                </div>

                <p class="mt-2 text-muted">Estimated delivery: 25â€“30 mins</p>

                <button class="move-checkout" (click)="checkout()">
                    <i class="bi bi-check-circle"></i> Checkout
                </button>

                <a class="btn btn-outline-primary w-100 mt-2" routerLink="/restaurant">
                    Want to add more items?
                </a>
                <br>
                <button class="btn btn-outline-danger btn-sm ms-auto" (click)="clear()">Clear Cart</button>
            </div>
        </div>
    </div>
</div>



<app-footer>